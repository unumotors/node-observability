version: "2"
services:
  # honey:
  #   image: honeycombio/honeycomb-opentracing-proxy
  #   ports:
  #   - 9411
  #   command:
  #   - -d
  #   - traces
  #   - -k
  #   - "d97cdd24ec7185106c08c374885fd388"
  #   - --debug
  #   # To also send spans to a Zipkin collector listening at
  #   # zipkin.default:9411, uncomment the following lines:
  #   - --downstream
  #   - http://zipkin-all-in-one:9411

  # Zipkin
  zipkin-all-in-one:
    image: openzipkin/zipkin:2.11.12
    environment:
    - "JAVA_OPTS=-Dlogging.level.zipkin=DEBUG -Dlogging.level.zipkin2=DEBUG"
    ports:
      - "19411:9411"
  # jeager
  jaeger-all-in-one:
    image: jaegertracing/all-in-one:1.8
    ports:
      - "14268:14268" # accept jaeger.thrift
      - "16686:16686" # frontend

  # Collector
  oc-collector:
    image: omnition/opencensus-collector:0.1.11
    command: ["--config=/etc/oc-collector-config.yaml","--log-level=debug", "--http-pprof-port=1777"]
    volumes:
      - ./oc-collector-config.yaml:/etc/oc-collector-config.yaml
    ports:
      - "9411:9411"
      - "55678:55678"
      - "14268"
      - "55680:55679"
      - "1777:1777"
      - "8888:8888" # Prometheus metrics
    depends_on:
      - zipkin-all-in-one
      - jaeger-all-in-one
    #  - honey



